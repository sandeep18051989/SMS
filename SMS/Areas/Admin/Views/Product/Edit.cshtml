@model SMS.Models.ProductModel
@using EF.Services;
@{
	ViewBag.Title = Model.Title;
	Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
	var basePath = EF.Core.ContextHelper.Current.Resolve<IUrlHelper>().GetLocation(false);
}
<div class="row">
	<div class="col-md-12 mr-4">
		<section class="edit-form">
			@using (Html.BeginForm())
			{
				@Html.AntiForgeryToken()
				@Html.HiddenFor(model => model.Id)
				<div class="row">
					<div id="admin-page-header" class="col-xs-12 col-md-12">
						<h3 class="section-heading mr-auto">EDIT PRODUCT</h3>
						<input type="submit" value="Save" class="btn btn-primary" />&nbsp;<span id="product-delete" class="btn btn-danger"><i class="fa fa-trash-o"></i> Delete</span>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						@Html.ValidationSummary(true, "", new { @class = "text-danger" })
					</div>
				</div>
				<hr />
				<div class="row text-left">
					<div class="col-md-12 mb-4">
						<div class="md-form">
							<i class="fa fa-play-circle-o prefix"></i>
							@Html.EditorFor(model => model.Title, new { htmlAttributes = new { @class = "form-control", @tabindex = "1", @maxlength = "50" } })
							@Html.LabelFor(model => model.Title, htmlAttributes: new { @class = "control-label col-md-2" })
							@Html.ValidationMessageFor(model => model.Title, "", new { @class = "text-danger" })
						</div>
					</div>
				</div>
				<div class="row text-left">
					<div class="col-md-10 mb-4">
						<div class="md-form">
							<i class="fa fa-html5 prefix"></i>
							@Html.EditorFor(model => model.Description, "HtmlEditor.cshtml")
							@Html.LabelFor(model => model.Description, htmlAttributes: new { @class = "control-label col-md-2" })
							@Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger" })
						</div>
					</div>
				</div>
				<div class="row text-left">
					<div class="col-md-12 mb-4">
						<div class="md-form">
							<i class="fa fa-link prefix"></i>
							@Html.EditorFor(model => model.SystemName, new { htmlAttributes = new { @class = "form-control", @tabindex = "3", @maxlength = "50" } })
							@Html.LabelFor(model => model.SystemName, htmlAttributes: new { @class = "control-label" })
							@Html.ValidationMessageFor(model => model.SystemName, "", new { @class = "text-danger" })
						</div>
					</div>
				</div>
				<div class="row text-left">
					<div class="col-md-12 mb-4">
						<div class="md-form">
							<i class="fa fa-file prefix"></i>
							@Html.EditorFor(model => model.FileId, "File.cshtml")
							@Html.ValidationMessageFor(model => model.FileId, "", new { @class = "text-danger" })
						</div>
					</div>
				</div>
				<div id="file-list" class="row" @(Model.Files.Count > 0 ? "" : "style=display:none;")>
					<div class="col-md-12 my-3 text-left">
						<div class="card">
							<div class="card-body">
								<div class="table-responsive">
									<table class="table product-table">
										<thead class="mdb-color lighten-5">
											<tr>
												<th style="text-align:center;" colspan="2">Files</th>
											</tr>
										</thead>
										<tbody id="file-grid-body">
											@foreach (var pic in Model.Files)
											{
												<script type="text/javascript">
															var cur_val = $('#fileids').val();
															if (cur_val)
																$('#fileids').val(cur_val + "," + @(pic.FileId));
															else
																$('#fileids').val(@(pic.FileId));
												</script>
												<tr id="@pic.FileId">
													<th scope="row"><div class="thumbnails"><img src="@(basePath)Content/images/file.png" alt="" class="img-thumbnail"></div></th>
													<td>
														<button type="button" class="btn btn-sm btn-primary waves-effect waves-light" data-toggle="tooltip" data-placement="top" title="" id="removefile_@(pic.FileId)" data-original-title="Remove item">X</button>
													</td>
												</tr>
											}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row text-left">
					<div class="col-md-12 mb-4">
						<div class="md-form">
							<i class="fa fa-picture-o prefix"></i>
							@Html.EditorFor(model => model.PictureId, "ProductPictureUpload.cshtml")
							@Html.ValidationMessageFor(model => model.PictureId, "", new { @class = "text-danger" })
						</div>
					</div>
				</div>
				<div @(Model.Pictures.Count > 0 ? "" : "style=display:none;") id="picture-list" class="row">
					<div class="col-md-12 my-3 text-left">
						<div class="card">
							<div class="card-body">
								<div class="table-responsive">
									<table class="table product-table">
										<thead class="mdb-color lighten-5">
											<tr>
												<th style="text-align:center;" colspan="2">Pictures</th>
											</tr>
										</thead>
										<tbody id="picture-grid-body">
											@foreach (var pic in Model.Pictures)
											{
											<script type="text/javascript">
															var cur_val = $('#pictureids').val();
															if (cur_val)
																$('#pictureids').val(cur_val + "," + @(pic.PictureId));
															else
																$('#pictureids').val(@(pic.PictureId));
											</script>
											<tr id="@pic.PictureId">
												<th scope="row"><img src="@(pic.PictureSrc)" alt="" class="img-fluid z-depth-0"></th>
												<td>
													<button type="button" class="btn btn-sm btn-primary waves-effect waves-light" data-toggle="tooltip" data-placement="top" title="" id="removepic_@(pic.PictureId)" data-original-title="Remove item">X</button>
												</td>
											</tr>
											}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row text-left">
					<div class="col-md-7 mb-4">
						<input type="checkbox" id="IsActive" name="IsActive" value="@(Model.IsActive ? true : false)" checked="@(Model.IsActive ? "checked" : "")" />
						@Html.LabelFor(model => model.IsActive, "Active", htmlAttributes: new { })
						@Html.ValidationMessageFor(model => model.IsActive, "", new { @class = "text-danger" })
					</div>
				</div>
			}
			@Html.DeleteConfirmation("product-delete")
		</section>
	</div>
</div>
