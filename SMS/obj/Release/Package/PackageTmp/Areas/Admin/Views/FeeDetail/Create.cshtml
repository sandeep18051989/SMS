@model SMS.Models.FeeDetailModel
@using EF.Services;
@{
	ViewBag.Title = "Enter Fee Detail";
	Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
<div class="row page-titles">
    <div class="col-md-5 align-self-center">
        <h3 class="text-themecolor">Add Fee Detail</h3>
    </div>
    <div class="col-md-7 align-self-center">
        @Html.Raw(Html.BuildBreadcrumbNavigation())
    </div>
</div>
<div class="row">
	<div class="col-md-12 mr-4">
		<section class="create-form">
			@using (Html.BeginForm())
			{
				@Html.AntiForgeryToken()
				@Html.HiddenFor(model => model.Id)
				<div class="row text-left">
					<div id="admin-page-header" class="col-xs-12 col-md-12">
						<button type="submit" name="save" class="btn btn-primary mr-auto">
							<i class="fa fa-save">&nbsp;&nbsp;</i>Create
						</button>
						<button type="submit" value="Create" name="save-continue" class="btn btn-primary mr-auto">
							<i class="fa fa-save">&nbsp;&nbsp;</i>Create & Continue
						</button>
					</div>
				</div>
				<div class="row">
					<div class="col-12 my-3">
						<div class="tab-content card">
							<div class="tab-pane fade in show active" id="feedetail" role="tabpanel">
								<div class="row">
									<div class="col-md-12">
										@Html.ValidationSummary(true, "", new { @class = "text-danger" })
									</div>
								</div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.DropDownListFor(model => model.StudentId, Model.AvailableStudents, "Select Student", new { @class = "mdb-select", @tabindex = "1" })
                                                    @Html.LabelFor(model => model.StudentId, "Student", htmlAttributes: new { @class = "control-label" })
                                                    @Html.ValidationMessageFor(model => model.StudentId, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.DropDownListFor(model => model.FeeCategoryStructureId, Model.AvailableFeeCategoryStructures, "Select Fee Category", new { @class = "mdb-select", @tabindex = "2" })
                                                    @Html.LabelFor(model => model.FeeCategoryStructureId, "Fee Category", htmlAttributes: new { @class = "control-label" })
                                                    @Html.ValidationMessageFor(model => model.FeeCategoryStructureId, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.DropDownListFor(model => model.AcadmicYearId, Model.AvailableAcadmicYears, new { @class = "mdb-select", @tabindex = "3" })
                                                    @Html.LabelFor(model => model.AcadmicYearId, "Acadmic Year", htmlAttributes: new { @class = "control-label" })
                                                    @Html.ValidationMessageFor(model => model.AcadmicYearId, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.DropDownListFor(model => model.CashierId, Model.AvailableEmployees, new { @class = "mdb-select", @tabindex = "4" })
                                                    @Html.LabelFor(model => model.AvailableEmployees, "Cashier", htmlAttributes: new { @class = "control-label" })
                                                    @Html.ValidationMessageFor(model => model.AvailableEmployees, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.DropDownListFor(model => model.StatusId, Model.AvailableStatuses, new { @class = "mdb-select", @tabindex = "5" })
                                                    @Html.LabelFor(model => model.StatusId, "Status", htmlAttributes: new { @class = "control-label" })
                                                    @Html.ValidationMessageFor(model => model.StatusId, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form date start-date">
                                                    @Html.EditorFor(model => model.Date, "Date.cshtml")
                                                    @Html.LabelFor(model => model.Date, htmlAttributes: new { @class = "control-label" })
                                                    @Html.ValidationMessageFor(model => model.Date, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form date end-date">
                                                    @Html.EditorFor(model => model.FeeType, new { htmlAttributes = new { @class = "form-control", @tabindex = "7", @maxlength = "100", @title = "Fee Type", @type = "text" } })
                                                    @Html.LabelFor(model => model.FeeType, "Fee Type", htmlAttributes: new { @class = "control-label", @data_error = "wrong", @data_success = "right" })
                                                    @Html.ValidationMessageFor(model => model.FeeType, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.EditorFor(model => model.PayingMode, new { htmlAttributes = new { @class = "form-control", @tabindex = "8", @maxlength = "100", @title = "Paying Mode", @type = "text" } })
                                                    @Html.LabelFor(model => model.PayingMode, "Mode", htmlAttributes: new { @class = "control-label", @data_error = "wrong", @data_success = "right" })
                                                    @Html.ValidationMessageFor(model => model.PayingMode, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.EditorFor(model => model.BankName, new { htmlAttributes = new { @class = "form-control", @tabindex = "9", @maxlength = "250", @title = "Bank", @type = "text" } })
                                                    @Html.LabelFor(model => model.BankName, "Bank", htmlAttributes: new { @class = "control-label", @data_error = "wrong", @data_success = "right" })
                                                    @Html.ValidationMessageFor(model => model.BankName, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.EditorFor(model => model.DDChequeNumber, new { htmlAttributes = new { @class = "form-control", @tabindex = "10", @maxlength = "100", @title = "DD/Cheque Number", @type = "text" } })
                                                    @Html.LabelFor(model => model.DDChequeNumber, "DD/Cheque Number", htmlAttributes: new { @class = "control-label", @data_error = "wrong", @data_success = "right" })
                                                    @Html.ValidationMessageFor(model => model.DDChequeNumber, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.EditorFor(model => model.TotalFees, new { htmlAttributes = new { @class = "form-control", @tabindex = "11", @maxlength = "8", @title = "Total Fees", @type = "number" } })
                                                    @Html.LabelFor(model => model.TotalFees, "Total Fees", htmlAttributes: new { @class = "control-label", @data_error = "wrong", @data_success = "right" })
                                                    @Html.ValidationMessageFor(model => model.TotalFees, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.EditorFor(model => model.FeesPaid, new { htmlAttributes = new { @class = "form-control", @tabindex = "12", @maxlength = "8", @title = "Total Fees", @type = "number" } })
                                                    @Html.LabelFor(model => model.FeesPaid, "Fees Paid", htmlAttributes: new { @class = "control-label", @data_error = "wrong", @data_success = "right" })
                                                    @Html.ValidationMessageFor(model => model.FeesPaid, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.EditorFor(model => model.PaidBy, new { htmlAttributes = new { @class = "form-control", @tabindex = "13", @maxlength = "100", @title = "Paid By", @type = "text" } })
                                                    @Html.LabelFor(model => model.PaidBy, "Paid By", htmlAttributes: new { @class = "control-label", @data_error = "wrong", @data_success = "right" })
                                                    @Html.ValidationMessageFor(model => model.PaidBy, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="col-md-6 mb-4">
                                                <div class="md-form">
                                                    @Html.TextAreaFor(model => model.Remarks, new { htmlAttributes = new { @class = "form-control", @tabindex = "14", @maxlength = "250", @title = "Remarks", @type = "text" } })
                                                    @Html.LabelFor(model => model.Remarks, "Remarks", htmlAttributes: new { @class = "control-label", @data_error = "wrong", @data_success = "right" })
                                                    @Html.ValidationMessageFor(model => model.Remarks, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
							</div>
						</div>
					</div>
				</div>
			}
		</section>
	</div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $("li#feedetails ul").css("height", "");
        $(document).on("change", '#@Html.IdFor(model => model.FeesPaid)', function () {
            if (($(this).val() != null && $(this).val() !== "") && ($('#@Html.IdFor(model => model.TotalFees)').val() != null && $('#@Html.IdFor(model => model.TotalFees)').val() !== "")) {
                var feePaid = parseFloat($(this).val());
                var totalFee = parseFloat($('#@Html.IdFor(model => model.TotalFees)').val());
                if (feePaid > totalFee) {
                    setTimeout(function () {
                        $.gritter.add({
                            title: "Failure",
                            text: "Fees paid cannot be greater than total fees!",
                            sticky: !0,
                            time: "",
                            class_name: "my-sticky-class"
                        });
                    }, 1e3);
                    $(this).val("");
                }
            }
        });

        $(document).on("change", '#@Html.IdFor(model => model.TotalFees)', function () {
            if (($(this).val() != null && $(this).val() !== "") && ($('#@Html.IdFor(model => model.FeesPaid)').val() != null && $('#@Html.IdFor(model => model.FeesPaid)').val() !== "")) {
                var totalFee = parseFloat($(this).val());
                var feePaid = parseFloat($('#@Html.IdFor(model => model.FeesPaid)').val());
                if (feePaid > totalFee) {
                    setTimeout(function () {
                        $.gritter.add({
                            title: "Failure",
                            text: "Fees paid cannot be greater than total fees!",
                            sticky: !0,
                            time: "",
                            class_name: "my-sticky-class"
                        });
                    }, 1e3);
                    $(this).val("");
                }
            }
        });
	});
</script>
